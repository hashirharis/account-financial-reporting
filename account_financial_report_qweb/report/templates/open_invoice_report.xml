<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

    <template id="open_invoice_report_qweb">

        <style type="text/css">
            td, th {font-size: 10px;}
            npage {font-size: 10px;}
        </style>

        <div class="header">
            <div class="row">
                <div class="col-xs-4 text-left">
                    <h6><span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/></h6>
                </div>
                <div class="col-xs-4 text-center">
                    <img t-if="res_company.logo" t-att-src="'data:image/png;base64,%s' % res_company.logo" style="max-height: 40px;"/>
                </div>
                <div class="col-xs-4 text-right">
                    <npage>
                        <ul class="list-inline">
                            <li><span class="page"/></li>
                            <li>/</li>
                            <li><span class="topage"/></li>
                        </ul>
                    </npage>
                </div>
            </div>
        </div>

        <t t-call="report.html_container">
            <t t-call="report.internal_layout">
                <div class="page">
                     <div class="row">
                        <table class="table table-bordered table-condensed" style="text-align: center;">
                            <thead>
                                <tr style="background-color:#e3e3e3;">
                                    <th>Company</th>
                                    <th>Fiscal Year</th>
                                    <th>At Date</th>
                                    <th>Accounts Filter</th>
                                    <th>Target Moves</th>
                                </tr>
                            </thead>
                            <tbody>
                                <td><span t-esc="general['company']"/></td>
                                <td><span t-esc="general['fiscal_year']"/></td>
                                <td><span t-esc="general['at_date']"/></td>
                                <td><span t-esc="general['account_filters']"/></td>
                                <td><span t-esc="general['target_moves']"/></td>
                            </tbody>
                        </table>
                        <br/>
                     </div>
                     <t t-foreach="data" t-as="account">
                         <t t-set="account_debit" t-value="0.0" />
                         <t t-set="account_credit" t-value="0.0" />
                         <t t-set="account_balance" t-value="0.0" />
                         <p><strong><span t-esc="account"/></strong></p>
                         <t t-foreach="data[account]" t-as="partner">
                            <t t-set="partner_debit" t-value="0.0" />
                            <t t-set="partner_credit" t-value="0.0" />
                            <t t-set="partner_balance" t-value="0.0" />
                            <p><strong><span t-esc="partner"/></strong></p>
                            <table class="table table-bordered table-condensed">
                                <thead>
                                    <tr style="background-color:#e3e3e3;">
                                        <th>Date</th>
                                        <th>Period</th>
                                        <th>Entry</th>
                                        <th>Journal</th>
                                        <th>Partner</th>
                                        <th>Reference</th>
                                        <th>Label</th>
                                        <th>Rec.</th>
                                        <th>Due Date</th>
                                        <th style="width:8%">Debit</th>
                                        <th style="width:8%">Credit</th>
                                        <th style="width:8%">Cumul.Bal.</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr t-foreach="data[account][partner]" t-as="move">
                                        <td><span t-esc="move['date']"/></td>
                                        <td><span t-esc="move['period']"/></td>
                                        <td><span t-esc="move['entry']"/></td>
                                        <td><span t-esc="move['journal']"/></td>
                                        <td><span t-esc="partner"/></td>
                                        <td><span t-esc="move['reference']"/></td>
                                        <td><span t-esc="move['label']"/></td>
                                        <td><span t-esc="move['rec']"/></td>
                                        <td><span t-esc="move['due_date']"/></td>
                                        <t t-set="account_debit" t-value="account_debit + move['debit']" />
                                        <t t-set="account_credit" t-value="account_credit + move['credit']" />
                                        <t t-set="account_balance" t-value="account_balance - move['credit'] + move['debit']" />
                                        <t t-set="partner_debit" t-value="partner_debit + move['debit']" />
                                        <t t-set="partner_credit" t-value="partner_credit + move['credit']" />
                                        <t t-set="partner_balance" t-value="partner_balance - move['credit'] + move['debit']" />
                                        <td class="text-right"><span t-esc="move['debit']"/></td>
                                        <td class="text-right"><span t-esc="move['credit']"/></td>
                                        <td class="text-right"><span t-esc="partner_balance" /></td>
                                    </tr>
                                    <tr>
                                        <td colspan="6"></td>
                                        <td colspan="3">Comulate Balance on Partner</td>
                                        <td class="text-right"><span t-esc="partner_debit" /></td>
                                        <td class="text-right"><span t-esc="partner_credit" /></td>
                                        <td class="text-right"><span t-esc="partner_balance" /></td>
                                    </tr>
                                </tbody>
                            </table>
                        </t>
                         <table class="table table-bordered table-condensed">
                             <tbody><tr>
                                <td colspan="9"><strong><span t-esc="account"/> Comulate Balance</strong></td>
                                <td class="text-right" style="width:8%"><span t-esc="account_debit" /></td>
                                <td class="text-right" style="width:8%"><span t-esc="account_credit" /></td>
                                <td class="text-right" style="width:8%"><span t-esc="account_balance" /></td></tr>
                             </tbody>
                         </table>
                         <br/>
                     </t>
                </div>
            </t>
        </t>

    </template>

</data>
</openerp>